[2K[1G[2m$ cross-env ci=true yarn test[22m
[2K[1G[2m$ cross-env NODE_ENV=test yarn jest[22m
[2K[1G[2m$ C:\Users\keego\Documents\repos\memory-snap\node_modules\.bin\jest[22m
[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2mcontrollers/socketio/[22m[1mindex.test.js[22m ([0m[1m[41m626.579 s[49m[22m[0m)
  socket.io
    [31m×[39m [2mresponds to ping (679 ms)[22m

[1m[31m  [1m● [22m[1msocket.io › responds to ping[39m[22m

    listen EADDRINUSE: address already in use :::7000
[2m[22m
[2m    [0m [90m 21 |[39m   [36mconst[39m httpServer [33m=[39m createServer()[33m;[39m[0m[22m
[2m    [0m [90m 22 |[39m   [36mconst[39m io [33m=[39m [36mnew[39m [33mServer[39m(httpServer)[33m;[39m[0m[22m
[2m    [0m[31m[1m>[22m[2m[39m[90m 23 |[39m   httpServer[33m.[39mlisten(process[33m.[39menv[33m.[39m[33mSOCKET_PORT[39m)[33m;[39m[0m[22m
[2m    [0m [90m    |[39m              [31m[1m^[22m[2m[39m[0m[22m
[2m    [0m [90m 24 |[39m[0m[22m
[2m    [0m [90m 25 |[39m   [36mconst[39m clientSocket [33m=[39m ioc([32m`ws://localhost:${process.env.SOCKET_PORT}`[39m[33m,[39m {[0m[22m
[2m    [0m [90m 26 |[39m     transports[33m:[39m [[32m'websocket'[39m][33m,[39m[0m[22m
[2m[22m
[2m      [2mat listen ([22m[2m__test__/helpers.js[2m:23:14)[22m[2m[22m
[2m      [2mat Object.<anonymous> ([22m[2m[0m[36mcontrollers/socketio/index.test.js[39m[0m[2m:9:45)[22m[2m[22m

[1m[31m  [1m● [22m[1msocket.io › responds to ping[39m[22m

    TypeError: Cannot read properties of undefined (reading 'disconnect')
[2m[22m
[2m    [0m [90m 16 |[39m[0m[22m
[2m    [0m [90m 17 |[39m   afterEach([36masync[39m () [33m=>[39m {[0m[22m
[2m    [0m[31m[1m>[22m[2m[39m[90m 18 |[39m     serverSocket[33m.[39mdisconnect()[33m;[39m[0m[22m
[2m    [0m [90m    |[39m                  [31m[1m^[22m[2m[39m[0m[22m
[2m    [0m [90m 19 |[39m     clientSocket[33m.[39mdisconnect()[33m;[39m[0m[22m
[2m    [0m [90m 20 |[39m     [36mawait[39m httpServer[33m.[39mclose()[33m;[39m[0m[22m
[2m    [0m [90m 21 |[39m     io[33m.[39mclose()[33m;[39m[0m[22m
[2m[22m
[2m      [2mat Object.disconnect ([22m[2m[0m[36mcontrollers/socketio/index.test.js[39m[0m[2m:18:18)[22m[2m[22m

[0m[7m[1m[31m FAIL [39m[22m[27m[0m [2m./[22m[1mapp.test.js[22m ([0m[1m[41m634.852 s[49m[22m[0m)
  app
    [31m×[39m [2mreturns photos array (5018 ms)[22m
    [32m√[39m [2mreturns error on fail (69 ms)[22m

[1m[31m  [1m● [22m[1mapp › returns photos array[39m[22m

    listen EADDRINUSE: address already in use :::4000
[2m[22m
[2m    [0m [90m 12 |[39m[0m[22m
[2m    [0m [90m 13 |[39m   beforeEach((done) [33m=>[39m {[0m[22m
[2m    [0m[31m[1m>[22m[2m[39m[90m 14 |[39m     server [33m=[39m app[33m.[39mlisten([35m4000[39m[33m,[39m (error) [33m=>[39m {[0m[22m
[2m    [0m [90m    |[39m                  [31m[1m^[22m[2m[39m[0m[22m
[2m    [0m [90m 15 |[39m       [36mif[39m (error) [36mreturn[39m done()[33m;[39m[0m[22m
[2m    [0m [90m 16 |[39m[0m[22m
[2m    [0m [90m 17 |[39m       agent [33m=[39m request[33m.[39magent(server)[33m;[39m[0m[22m
[2m[22m
[2m      [2mat Function.listen ([22m[2m../../node_modules/express/lib/application.js[2m:635:24)[22m[2m[22m
[2m      [2mat Object.listen ([22m[2m[0m[36mapp.test.js[39m[0m[2m:14:18)[22m[2m[22m

[1m[31m  [1m● [22m[1mapp › returns photos array[39m[22m

    thrown: "Exceeded timeout of 5000 ms for a hook while waiting for `done()` to be called.
    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout."
[2m[22m
[2m    [0m [90m 11 |[39m   [36mlet[39m agent[33m;[39m[0m[22m
[2m    [0m [90m 12 |[39m[0m[22m
[2m    [0m[31m[1m>[22m[2m[39m[90m 13 |[39m   beforeEach((done) [33m=>[39m {[0m[22m
[2m    [0m [90m    |[39m   [31m[1m^[22m[2m[39m[0m[22m
[2m    [0m [90m 14 |[39m     server [33m=[39m app[33m.[39mlisten([35m4000[39m[33m,[39m (error) [33m=>[39m {[0m[22m
[2m    [0m [90m 15 |[39m       [36mif[39m (error) [36mreturn[39m done()[33m;[39m[0m[22m
[2m    [0m [90m 16 |[39m[0m[22m
[2m[22m
[2m      [2mat beforeEach ([22m[2m[0m[36mapp.test.js[39m[0m[2m:13:3)[22m[2m[22m
[2m      [2mat Object.describe ([22m[2m[0m[36mapp.test.js[39m[0m[2m:9:1)[22m[2m[22m

[33mA worker process has failed to exit gracefully and has been force exited. This is likely caused by tests leaking due to improper teardown. Try running with --detectOpenHandles to find leaks. Active timers can also cause this, ensure that .unref() was called on them.[39m
[1mTest Suites: [22m[1m[31m2 failed[39m[22m, 2 total
[1mTests:       [22m[1m[31m2 failed[39m[22m, [1m[32m1 passed[39m[22m, 3 total
[1mSnapshots:   [22m0 total
[1mTime:[22m        [1m[33m640.331 s[39m[22m
[2mRan all test suites[22m[2m.[22m
[2K[1G[31merror[39m Command failed with exit code 1.
[2K[1G[94minfo[39m Visit [1mhttps://yarnpkg.com/en/docs/cli/run[22m for documentation about this command.
[2K[1G[31merror[39m Command failed with exit code 1.
[2K[1G[94minfo[39m Visit [1mhttps://yarnpkg.com/en/docs/cli/run[22m for documentation about this command.
[2K[1G[31merror[39m Command failed with exit code 1.
[2K[1G[94minfo[39m Visit [1mhttps://yarnpkg.com/en/docs/cli/run[22m for documentation about this command.
